test code with bug fixes
Code checked by Developer1 
